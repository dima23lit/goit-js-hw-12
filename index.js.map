{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nlet APIKEY = '44929150-af2bf51de3b27508be12093c9';\n\nexport let perPage = 15;\n\nexport async function getImagesByQuery(query, page = 1) {\n    const result = await axios.get(\"https://pixabay.com/api/\", {\n        params: {\n            key: APIKEY,\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            per_page: perPage,\n            page\n        }\n    })\n\n    return result.data\n}","// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('#loader');\nconst btnLoadMore = document.querySelector('.btn-load-more');\n\nlet simpleLightboxnew = new SimpleLightbox('.gallery li a', {\n    captions: true,\n    captionSelector: 'a img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionDelay: 250\n});\n\nexport function createGallery(images) {\n\n    gallery.insertAdjacentHTML('beforeend', images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n           <a class=\"gallery-link\" href=\"${largeImageURL}\">\n           <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\n           <div class=\"social-items\">\n              <div class=\"field\">\n              <span class=\"value\" data-likes>Likes</span>\n              <span class=\"label\">${likes}</span>\n              </div>\n              <div class=\"field\">\n              <span class=\"value\" data-views>Views</span>\n              <span class=\"label\">${views}</span>\n              </div>\n              <div class=\"field\">\n              <span class=\"value\" data-comments>Coments</span>\n              <span class=\"label\">${comments}</span>\n              </div>\n              <div class=\"field\">\n              <span class=\"value\" data-downloads>Downloads</span>\n              <span class=\"label\">${downloads}</span>\n              </div>\n           </div>\n           </a>\n           </li>`\n    ).join(\"\"))\n                            \n    simpleLightboxnew.refresh()\n}\n\nexport function clearGallery() {\n    gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n    loader.style.display = \"inline-block\"\n}\n\nexport function hideLoader() {\n    loader.style.display = \"none\"\n}\n\nexport function showLoadMoreButton() {\n    btnLoadMore.removeAttribute('hidden')\n}\n\nexport function hideLoadMoreButton() {\n    btnLoadMore.setAttribute('hidden', '')\n}","// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery, perPage } from \"./js/pixabay-api\";\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from \"./js/render-functions\";\n\nconst form = document.querySelector('.form');\nconst btnLoadMore = document.querySelector('.btn-load-more');\nlet currentTargetValue;\n\nlet page;\n\nform.addEventListener('submit', handleForm);\n\nbtnLoadMore.addEventListener('click', handleClick)\n\nasync function handleForm(event) {\n    event.preventDefault()\n\n    page = 1;\n    \n\n    currentTargetValue = event.target.elements[0].value.trim();\n        \n    if (currentTargetValue === \"\") {\n        iziToast.show({\n            message: \"Please, fill out the form\",\n            position: 'topRight',\n            backgroundColor: '#EF4040',\n            titleColor: '#fff',\n            messageColor: '#fff',\n            close: true,\n        })\n        return\n    }\n\n    hideLoadMoreButton();\n    clearGallery()\n    showLoader()\n\n    try {\n        await getImagesByQuery(currentTargetValue, page)\n            .then(response => {\n                if (response.hits.length >= 1) {\n\n                    createGallery(response.hits)\n\n                    const totalPages = Math.ceil(response.totalHits / perPage);\n\n                    if (page < totalPages) {\n                        showLoadMoreButton();\n                    } else {\n                        hideLoadMoreButton();\n                    }\n                    \n                } else {\n                    iziToast.show({\n                        message: \"Sorry, there are no images matching your search query. Please try again!\",\n                        position: 'topRight',\n                        backgroundColor: '#EF4040',\n                        titleColor: '#fff',\n                        messageColor: '#fff',\n                        close: true,\n                    })\n                }\n            }\n            )\n    } catch (error) {\n        iziToast.show({\n            message: error.message,\n            position: 'topRight',\n            backgroundColor: '#EF4040',\n            titleColor: '#fff',\n            messageColor: '#fff',\n            close: true,\n        })\n    } finally {\n        hideLoader()\n    }\n\n}\n\n\nasync function handleClick() {\n\n    page += 1;\n\n    showLoader();\n    hideLoadMoreButton();\n    \n    try {\n        \n        const data = await getImagesByQuery(currentTargetValue, page);\n\n        createGallery(data.hits)\n\n        const totalPages = Math.ceil(data.totalHits / perPage);\n\n        console.log(page >= totalPages)\n\n        if (page >= totalPages) {\n            iziToast.show({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n                backgroundColor: '#EF4040',\n                titleColor: '#fff',\n                messageColor: '#fff',\n                close: true,\n            })\n            hideLoadMoreButton();\n        } else {\n            showLoadMoreButton()\n        }\n        \n        const galleryItem = document.querySelector('.gallery-item');\n        const item = galleryItem.getBoundingClientRect();\n\n        if (!(galleryItem)) {\n            return\n        } else {\n                window.scrollBy({\n                    top: item.height * 2,\n                    behavior: \"smooth\",\n                });\n        }\n\n    } catch (error) {\n        iziToast.show({\n            message: error.message,\n            position: 'topRight',\n            backgroundColor: '#EF4040',\n            titleColor: '#fff',\n            messageColor: '#fff',\n            close: true,\n        })\n    } finally {\n        hideLoader()\n    }\n}"],"names":["APIKEY","perPage","getImagesByQuery","query","page","axios","gallery","loader","btnLoadMore","simpleLightboxnew","SimpleLightbox","createGallery","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","currentTargetValue","handleForm","handleClick","event","iziToast","response","totalPages","error","data","galleryItem","item"],"mappings":"owBAEA,IAAIA,EAAS,qCAEFC,EAAU,GAEd,eAAeC,EAAiBC,EAAOC,EAAO,EAAG,CAapD,OAZe,MAAMC,EAAM,IAAI,2BAA4B,CACvD,OAAQ,CACJ,IAAKL,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAAG,CACH,CACT,CAAK,GAEa,IAClB,CCfA,MAAME,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIC,EAAoB,IAAIC,EAAe,gBAAiB,CACxD,SAAU,GACV,gBAAiB,QACjB,YAAa,OACb,aAAc,MACd,aAAc,GAClB,CAAC,EAEM,SAASC,EAAcC,EAAQ,CAElCN,EAAQ,mBAAmB,YAAaM,EAAO,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IACxH;AAAA,2CACmCL,CAAa;AAAA,6CACXD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,oCAInCC,CAAK;AAAA;AAAA;AAAA;AAAA,oCAILC,CAAK;AAAA;AAAA;AAAA;AAAA,oCAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,oCAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,iBAK7C,EAAM,KAAK,EAAE,CAAC,EAEVV,EAAkB,QAAS,CAC/B,CAEO,SAASW,GAAe,CAC3Bd,EAAQ,UAAY,EACxB,CAEO,SAASe,GAAa,CACzBd,EAAO,MAAM,QAAU,cAC3B,CAEO,SAASe,GAAa,CACzBf,EAAO,MAAM,QAAU,MAC3B,CAEO,SAASgB,GAAqB,CACjCf,EAAY,gBAAgB,QAAQ,CACxC,CAEO,SAASgB,GAAqB,CACjChB,EAAY,aAAa,SAAU,EAAE,CACzC,CC1DA,MAAMiB,EAAO,SAAS,cAAc,OAAO,EACrCjB,EAAc,SAAS,cAAc,gBAAgB,EAC3D,IAAIkB,EAEAtB,EAEJqB,EAAK,iBAAiB,SAAUE,CAAU,EAE1CnB,EAAY,iBAAiB,QAASoB,CAAW,EAEjD,eAAeD,EAAWE,EAAO,CAQ7B,GAPAA,EAAM,eAAgB,EAEtBzB,EAAO,EAGPsB,EAAqBG,EAAM,OAAO,SAAS,CAAC,EAAE,MAAM,OAEhDH,IAAuB,GAAI,CAC3BI,EAAS,KAAK,CACV,QAAS,4BACT,SAAU,WACV,gBAAiB,UACjB,WAAY,OACZ,aAAc,OACd,MAAO,EACnB,CAAS,EACD,MACH,CAEDN,IACAJ,EAAc,EACdC,EAAY,EAEZ,GAAI,CACA,MAAMnB,EAAiBwB,EAAoBtB,CAAI,EAC1C,KAAK2B,GAAY,CACd,GAAIA,EAAS,KAAK,QAAU,EAAG,CAE3BpB,EAAcoB,EAAS,IAAI,EAE3B,MAAMC,EAAa,KAAK,KAAKD,EAAS,UAAY9B,CAAO,EAErDG,EAAO4B,EACPT,IAEAC,GAGxB,MACoBM,EAAS,KAAK,CACV,QAAS,2EACT,SAAU,WACV,gBAAiB,UACjB,WAAY,OACZ,aAAc,OACd,MAAO,EAC/B,CAAqB,CAER,CACA,CACR,OAAQG,EAAO,CACZH,EAAS,KAAK,CACV,QAASG,EAAM,QACf,SAAU,WACV,gBAAiB,UACjB,WAAY,OACZ,aAAc,OACd,MAAO,EACnB,CAAS,CACT,QAAc,CACNX,EAAY,CACf,CAEL,CAGA,eAAeM,GAAc,CAEzBxB,GAAQ,EAERiB,IACAG,IAEA,GAAI,CAEA,MAAMU,EAAO,MAAMhC,EAAiBwB,EAAoBtB,CAAI,EAE5DO,EAAcuB,EAAK,IAAI,EAEvB,MAAMF,EAAa,KAAK,KAAKE,EAAK,UAAYjC,CAAO,EAErD,QAAQ,IAAIG,GAAQ4B,CAAU,EAE1B5B,GAAQ4B,GACRF,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,WACV,gBAAiB,UACjB,WAAY,OACZ,aAAc,OACd,MAAO,EACvB,CAAa,EACDN,KAEAD,EAAoB,EAGxB,MAAMY,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAOD,EAAY,wBAEzB,GAAMA,EAGE,OAAO,SAAS,CACZ,IAAKC,EAAK,OAAS,EACnB,SAAU,QAC9B,CAAiB,MALL,OAQP,OAAQH,EAAO,CACZH,EAAS,KAAK,CACV,QAASG,EAAM,QACf,SAAU,WACV,gBAAiB,UACjB,WAAY,OACZ,aAAc,OACd,MAAO,EACnB,CAAS,CACT,QAAc,CACNX,EAAY,CACf,CACL"}